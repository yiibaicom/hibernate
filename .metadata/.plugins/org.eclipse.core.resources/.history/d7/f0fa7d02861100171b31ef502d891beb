package src.com.yiibai;

import org.hibernate.Session;
import org.hibernate.SessionFactory;
import org.hibernate.Transaction;
import org.hibernate.boot.MetadataSources;
import org.hibernate.boot.registry.StandardServiceRegistry;
import org.hibernate.boot.registry.StandardServiceRegistryBuilder;


public class StoreData {
	public static void main(String[] args) {
		// ç›¸å¯¹äº?.x.xç‰ˆæœ¬hibernateï¼Œæˆ‘ä»¬åœ¨4.x.xé‡‡ç”¨å¦‚ä¸‹æ–¹å¼è·å–æˆ‘ä»¬çš„ä¼šè¯å·¥å‚ï¼š
		// 1. è§£ææˆ‘ä»¬åœ¨hibernate.cfg.xmlä¸­çš„é…ç½®
		// Configuration configuration = new Configuration().configure();
		// 2. åˆ›å»ºæœåŠ¡æ³¨å†Œç±?è¿›ä¸€æ­¥æ³¨å†Œåˆå§‹åŒ–æˆ‘ä»¬é…ç½®æ–‡ä»¶ä¸­çš„å±æ?
		// ServiceRegistry serviceRegistry = new
		// ServiceRegistryBuilder().applySettings(configuration.getProperties()).buildServiceRegistry();
		// 3. åˆ›å»ºæˆ‘ä»¬çš„æ•°æ®åº“è®¿é—®ä¼šè¯å·¥å‚
		// SessionFactory sessionFactory =
		// configuration.buildSessionFactory(serviceRegistry);

		// ä½†åœ¨5.1.0ç‰ˆæœ¬æ±‡æ?ï¼Œhibernateåˆ™é‡‡ç”¨å¦‚ä¸‹æ–°æ–¹å¼è·å–ï¼?
		// 1. é…ç½®ç±»å‹å®‰å…¨çš„å‡†æœåŠ¡æ³¨å†Œç±»ï¼Œè¿™æ˜¯å½“å‰åº”ç”¨çš„å•ä¾‹å¯¹è±¡ï¼Œä¸ä½œä¿®æ”¹ï¼Œæ‰€ä»¥å£°æ˜ä¸ºfinal
		// åœ¨configure("cfg/hibernate.cfg.xml")æ–¹æ³•ä¸­ï¼Œå¦‚æœä¸æŒ‡å®šèµ„æºè·¯å¾„ï¼Œé»˜è®¤åœ¨ç±»è·¯å¾„ä¸‹å¯»æ‰¾åä¸ºhibernate.cfg.xmlçš„æ–‡ä»?
		final StandardServiceRegistry registry = new StandardServiceRegistryBuilder().configure("hibernate.cfg.xml")
				.build();
		// 2. æ ¹æ®æœåŠ¡æ³¨å†Œç±»åˆ›å»ºä¸€ä¸ªå…ƒæ•°æ®èµ„æºé›†ï¼ŒåŒæ—¶æ„å»ºå…ƒæ•°æ®å¹¶ç”Ÿæˆåº”ç”¨ä¸?ˆ¬å”¯ä¸€çš„çš„sessionå·¥å‚
		SessionFactory sessionFactory = new MetadataSources(registry).buildMetadata().buildSessionFactory();

		/**** ä¸Šé¢æ˜¯é…ç½®å‡†å¤‡ï¼Œä¸‹é¢å¼?§‹æˆ‘ä»¬çš„æ•°æ®åº“æ“ä½œ ******/
		Session session = sessionFactory.openSession();// ä»ä¼šè¯å·¥å‚è·å–ä¸€ä¸ªsession

		// creating transaction object
		Transaction t = session.beginTransaction();

		Employee e1 = new Employee();
		e1.setId(100);
		e1.setFirstName("Max");
		e1.setLastName("Su");

		session.save(e1);// persisting the object

		t.commit();// transaction is commited
		session.close();

		System.out.println("successfully saved");

	}
}
